#include <iostream>
#include <vector>
#include <algorithm>
#include <queue>

using namespace std;

typedef long long int ll;
ll n;
ll m;
ll endpoint;
ll diff;
ll enjoy;
ll nodeVal[100005];
ll par[100005];
vector<pair<ll, ll>> friends[11];

vector<ll> maxDiff[100005];
ll curDiff[100005];
ll skill;
ll courage;
ll ans[100005];

vector<ll> add(int pos, vector<ll> list, int val) {
    vector<ll> res;

    for (int i = 0; i < pos; i++) {
        res.push_back(list[i]);
    }
    res.push_back(val);
    for (int i = pos; i < list.size(); i++) {
        res.push_back(list[i]);
    }
    if (res.size() > 11) {
        res.resize(11); // 11 courage levels
    }

    return res;
}

int main()
{
    ios::sync_with_stdio(false);
    cin.tie(0);

    cin >> n;

    maxDiff[1].push_back(0);
    for (int i = 1; i <= n; i++) {
        nodeVal[i] = 0;
    }
    for (int i = 2; i <= n; i++) {
        cin >> endpoint >> diff >> enjoy;

        par[i] = endpoint;
        maxDiff[i].push_back(diff);
        nodeVal[i] = enjoy;
        curDiff[i] = diff;
    }
    cin >> m;

    for (int i = 0; i < m; i++) {
        cin >> skill >> courage;

        friends[courage].push_back({ skill, i });
    }
    for (int i = 2; i <= n; i++) {
        nodeVal[i] += nodeVal[par[i]];
        maxDiff[i] = maxDiff[par[i]];

        int j = 0;

        while (j < maxDiff[i].size() && curDiff[i] <= maxDiff[i][j]) {
            j++;
        }
        maxDiff[i] = add(j, maxDiff[i], curDiff[i]);
    }
    for (int i = 1; i <= n; i++) {
        maxDiff[i].resize(11);
    }
    vector<pair<ll, ll>> nodeVals;

    for (int c = 0; c <= 10; c++) {
        nodeVals.clear();

        for (int i = 1; i <= n; i++) {
            nodeVals.push_back({ maxDiff[i][c], nodeVal[i] });
        }
        sort(nodeVals.begin(), nodeVals.end());
        sort(friends[c].begin(), friends[c].end());

        ll res = 0;
        int j = 0;
        for (int i = 0; i < friends[c].size(); i++) {
            ll curSkill = friends[c][i].first;
            while (j < nodeVals.size() && nodeVals[j].first <= curSkill) {
                res = max(res, nodeVals[j].second);
                j++;
            }
            ans[friends[c][i].second] = res;
        }
    }
    for (int i = 0; i < m; i++) {
        cout << ans[i] << endl;
    }
}
